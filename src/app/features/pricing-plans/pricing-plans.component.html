<div
  class="rounded border border-gray-100 bg-white p-5 shadow-main dark:border-dark-500 dark:bg-dark-200">
  <div class="mb-5 flex gap-4 md:flex-row md:items-center md:justify-between">
    <app-search-input
      (search)="onSearchTriggered($event)"
      class="w-full md:w-64" />

    <div class="flex gap-3 sm:flex-row sm:items-center sm:gap-4">
      <p-select
        [options]="statusSelectOptions()"
        [ngModel]="statusSelect()"
        (ngModelChange)="onStatusSelectChange($event)"
        optionLabel="name"
        placeholder="Chọn trạng thái hoạt động"
        class="!dark:bg-dark-200 flex h-11 w-full items-center sm:w-56" />

      <div class="flex gap-2">
        <a routerLink="create">
          <app-button [variant]="'outline'" class="flex items-center">
            <span
              class="material-symbols-outlined relative top-[3px] mr-1 text-lg leading-none">
              add
            </span>
            <span>Thêm gói</span>
          </app-button>
        </a>

        <a routerLink="create">
          <app-button [variant]="'outline'" class="flex items-center">
            <span
              class="material-symbols-outlined relative top-[3px] mr-1 text-lg leading-none"
              >download</span
            >
            <span>Export</span>
          </app-button>
        </a>
      </div>
    </div>
  </div>

  <p-table
    [value]="pricingPlans()"
    [tableStyle]="{ 'min-width': '50rem' }"
    [paginator]="true"
    [lazy]="true"
    [rows]="rows()"
    [first]="first()"
    [showCurrentPageReport]="true"
    (onLazyLoad)="loadDataLazy($event)"
    [totalRecords]="totalPricingPlans()"
    currentPageReportTemplate="Hiển thị {first} đến {last} trên {totalRecords} gói đăng ký">
    <ng-template pTemplate="header">
      <tr>
        <th scope="col" class="!w-[5%] !text-center">STT</th>
        <th scope="col" class="!w-[15%]" pSortableColumn="name">
          <span class="mr-2">Tên</span><p-sortIcon field="name" />
        </th>
        <th scope="col" pSortableColumn="storage">
          Dung lượng<p-sortIcon field="storage" />
        </th>
        <th scope="col" pSortableColumn="users">
          <div class="flex items-center">
            <span class="mr-2">Số lượng<br />tài khoản</span>
            <p-sortIcon field="users" />
          </div>
        </th>
        <th scope="col" pSortableColumn="monthly">
          Gói tháng <p-sortIcon field="monthly" />
        </th>
        <th scope="col" pSortableColumn="yearly">
          Gói năm <p-sortIcon field="yearly" />
        </th>
        <th scope="col" class="!w-[10%] !text-center">Trạng thái</th>
        <th scope="col" class="!w-[15%] !text-center">Hành động</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-pricing let-i="rowIndex">
      <tr>
        <td class="!text-center">{{ i + 1 | leadingZero }}</td>
        <td>{{ pricing.name }}</td>
        <td>{{ pricing.storageLimitGB }} GB</td>
        <td>{{ pricing.maxUsers }}</td>
        <td>
          {{
            pricing.priceMonthly
              | currency: 'VND' : 'symbol' : '1.0-0' : 'vi-VN'
          }}
        </td>
        <td>
          {{
            pricing.pricePerYear
              | currency: 'VND' : 'symbol' : '1.0-0' : 'vi-VN'
          }}
        </td>
        <td class="!text-center">
          <app-badge
            [variant]="pricing.status === 0 ? 'success' : 'destructive'">
            {{ pricing.status === 0 ? 'Đang hoạt động' : 'Vô hiệu hóa' }}
          </app-badge>
        </td>
        <td class="!text-center">
          <div class="flex items-center justify-center gap-2">
            <a [routerLink]="['/pricing-plans', pricing.id]">
              <app-button
                pTooltip="Xem chi tiết"
                tooltipPosition="top"
                [variant]="'light'"
                [size]="'xs'"
                class="material-symbols-outlined rounded-full px-[7px] pb-[6px] pt-[8px] text-lg leading-none"
                >visibility</app-button
              >
            </a>
            <a [routerLink]="['/pricing-plans', pricing.id, 'update']">
              <app-button
                pTooltip="Chỉnh sửa"
                tooltipPosition="top"
                [variant]="'light'"
                [size]="'xs'"
                class="material-symbols-outlined rounded-full px-[7px] pb-[6px] pt-[8px] text-lg leading-none"
                >edit</app-button
              >
            </a>
            <app-button
              pTooltip="Vô hiệu hóa"
              tooltipPosition="top"
              (clicked)="openConfirmDialog($event, pricing.id)"
              [variant]="'light-danger'"
              class="material-symbols-outlined rounded-full px-[7px] py-[7px] text-lg leading-none"
              >unarchive</app-button
            >
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
