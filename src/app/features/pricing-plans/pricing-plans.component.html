<div
  class="rounded border border-gray-100 bg-white p-5 shadow-main dark:border-dark-500 dark:bg-dark-200">
  <div class="mb-5 flex items-center justify-between">
    <app-search-input (search)="onSearchTriggered($event)" />
    <a [routerLink]="['create']"><app-button>Tạo mới</app-button></a>
  </div>

  <p-table
    [value]="pagedPricingPlans"
    [tableStyle]="{ 'min-width': '50rem' }"
    [paginator]="true"
    [rows]="10"
    [lazy]="true"
    [first]="first()"
    [showCurrentPageReport]="true"
    (onLazyLoad)="loadProductsLazy($event)"
    [totalRecords]="totalRecords()"
    currentPageReportTemplate="
      Hiển thị {first} đến {last} trên {totalRecords} gói đăng ký
    "
    (onPage)="pageChange($event)"
    [loading]="loading()">
    <ng-template #header>
      <tr>
        <th scope="col" class="!w-[5%] !text-center">STT</th>
        <th scope="col" class="!w-[20%]">Tên</th>
        <th scope="col">Dung lượng</th>
        <th scope="col">Credit</th>
        <th scope="col">Tài khoản</th>
        <th scope="col">Giá thành</th>
        <th scope="col" class="!w-[10%] !text-center">Trạng thái</th>
        <th scope="col" class="!w-[15%] !pr-4 !text-center">Hành động</th>
      </tr>
    </ng-template>
    <ng-template #body let-pricing let-i="rowIndex">
      <tr>
        <td class="!text-center">{{ i + 1 | leadingZero }}</td>
        <td>
          {{ pricing.name }}
        </td>
        <td>{{ pricing.storageLimit }} GB</td>
        <td>{{ pricing.creditLimit }}</td>
        <td>{{ pricing.maxAccounts }}</td>
        <td>
          {{ pricing.price | currency: 'VND' : 'symbol' : '1.0-0' : 'vi-VN' }}
        </td>
        <td class="!text-center">
          <app-badge
            class="whitespace-nowrap"
            [variant]="pricing.status === 'active' ? 'success' : 'destructive'"
            >{{
              pricing.status === 'active' ? 'Đang hoạt động' : 'Vô hiệu hóa'
            }}</app-badge
          >
        </td>
        <td class="!text-center">
          <div class="flex items-center justify-center gap-2">
            <a [routerLink]="['/admin/pricing-plans', pricing.id]">
              <app-button
                pTooltip="Xem chi tiết"
                tooltipPosition="top"
                [variant]="'light'"
                [size]="'xs'"
                class="material-symbols-outlined rounded-full px-[7px] pb-[6px] pt-[8px] text-lg leading-none"
                >visibility</app-button
              >
            </a>
            <a [routerLink]="['/admin/pricing-plans', pricing.id, 'update']">
              <app-button
                pTooltip="Chỉnh sửa"
                tooltipPosition="top"
                [variant]="'light'"
                [size]="'xs'"
                class="material-symbols-outlined rounded-full px-[7px] pb-[6px] pt-[8px] text-lg leading-none"
                >edit</app-button
              >
            </a>
            <app-button
              pTooltip="Vô hiệu hóa"
              tooltipPosition="top"
              (clicked)="openUnarchiveDialog()"
              [variant]="'light-danger'"
              class="material-symbols-outlined rounded-full px-[7px] py-[7px] text-lg leading-none"
              >unarchive</app-button
            >
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<app-dialog #unarchiveDialogRef [title]="'Vô hiệu hóa school admin'">
  <p class="mt-4 dark:text-dark-100" dialog-body>
    Bạn có chắc chắn muốn vô hiệu hóa pricing plan này? Nó sẽ không xuất hiện
    trên hệ thống nữa.
  </p>
  <div footer class="flex justify-end gap-2">
    <app-button [theme]="'danger'" (click)="unarchiveDialogRef.hideDialog()"
      >Hủy</app-button
    >
    <app-button>Xác nhận</app-button>
  </div>
</app-dialog>
